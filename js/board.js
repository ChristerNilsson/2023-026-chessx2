// Generated by CoffeeScript 2.5.1
var getNextQuestion,
  modulo = function(a, b) { return (+a % (b = +b) + b) % b; };

import _ from 'https://cdn.skypack.dev/lodash';

import {
  ass,
  lerp,
  param,
  range,
  hexToBase64,
  enterFullscreen
} from '../js/utils.js';

import {
  Square
} from '../js/square.js';

import {
  Button
} from '../js/button.js';

import {
  coords,
  clickString,
  global,
  toObjectNotation,
  toUCI
} from '../js/globals.js';

import {
  dumpState
} from '../js/globals.js';

//SIZE = global.SIZE
getNextQuestion = () => {
  var g, i, k, l, len, len1, move, moves, qi, ref, sr;
  g = global;
  sr = g.spacedRepetition;
  if (sr.boxes[0].length === 0) {
    ref = range(5);
    for (k = 0, len = ref.length; k < len; k++) {
      i = ref[k];
      if (sr.qindex < sr.questions.length - 1) {
        qi = sr.questions[sr.qindex];
        sr.add({
          p: g.tree.arr[qi][3],
          q: g.tree.getPath(qi),
          a: g.tree.getAnswers(qi, sr.stopp)
        });
        sr.qindex++;
      }
    }
  }
  sr.pick();
  g.chess.reset();
  moves = sr.current().q.split('.');
  for (l = 0, len1 = moves.length; l < len1; l++) {
    move = moves[l];
    g.chess.move({
      from: move.slice(0, 2),
      to: move.slice(2, 4)
    });
  }
  return g.board.flipped = moves.length % 2 === 1;
};

export var Board = class Board {
  constructor(nr) {
    var i, k, len, ref;
    this.click = this.click.bind(this);
    // if uci in sr.answers
    // sr.wrong()
    // getNextQuestion()
    // @clickedSquares = []
    // else
    // 	@clickedSquares = @clickedSquares.slice 0,2
    this.draw = this.draw.bind(this);
    //@littera()
    this.littera = this.littera.bind(this);
    this.flip = this.flip.bind(this);
    this.nr = nr;
    this.squares = [];
    this.clickedSquares = [];
    this.pieces = "";
    this.flipped = false;
    ref = range(64);
    for (k = 0, len = ref.length; k < len; k++) {
      i = ref[k];
      ((i) => {
        return this.squares.push(new Square(this.nr, i, () => {
          return this.click(i);
        }));
      })(i);
    }
    this.buttons = [];
  }

  click(i) {
    var col, color, csl, g, row, sq, uci;
    g = global;
    // sr = g.spacedRepetition
    if (this.flipped) {
      i = 63 - i;
    }
    col = modulo(i, 8);
    row = 7 - Math.floor(i / 8);
    sq = g.chess.board()[row][col];
    color = "wb"[modulo(g.chess.history().length, 2)];
    csl = this.clickedSquares.length;
    if (csl === 0) {
      if (sq !== null && sq.color === color) {
        return this.clickedSquares.push(i);
      }
    } else if (csl === 1) {
      if (i === this.clickedSquares[0]) {
        return this.clickedSquares = []; // kontrollera draget
      } else {
        this.clickedSquares.push(i);
        return uci = toUCI(this.clickedSquares);
      }
    // if uci in sr.answers
    // sr.correct()
    // getNextQuestion()
    // @clickedSquares = []
    } else if (csl === 2) {
      return this.clickedSquares.push(i);
    } else if (csl === 3) {
      this.clickedSquares.push(i);
      return uci = toUCI(this.clickedSquares.slice(2, 4));
    }
  }

  draw() {
    var button, i, j, k, l, len, len1, len2, m, piece, ref, ref1, ref2, ref3, ref4, ref5, sq;
    ref = this.buttons;
    for (k = 0, len = ref.length; k < len; k++) {
      button = ref[k];
      button.draw();
    }
    fill('white');
    textSize(global.SIZE * 0.3);
    if (this.nr === 0) {
      push();
      translate(global.mx, global.my);
    } else {
      push();
      translate(global.mx, global.my + 9 * global.SIZE);
    }
    ref1 = range(8);
    for (l = 0, len1 = ref1.length; l < len1; l++) {
      i = ref1[l];
      ref2 = range(8);
      for (m = 0, len2 = ref2.length; m < len2; m++) {
        j = ref2[m];
        piece = global.chess.board()[7 - i][j];
        sq = this.squares[i * 8 + j];
        if ((ref3 = this.clickedSquares.length) === 0 || ref3 === 2) {
          sq.draw(piece, this.flipped, false);
        }
        if ((ref4 = this.clickedSquares.length) === 1) {
          sq.draw(piece, this.flipped, i * 8 + j === this.clickedSquares[0]);
        } else if ((ref5 = this.clickedSquares.length) === 3 || ref5 === 4) {
          sq.draw(piece, this.flipped, i * 8 + j === this.clickedSquares[2]);
        }
      }
    }
    stroke('black');
    noFill();
    rect(global.SIZE * 4, global.SIZE * 4, global.SIZE * 8, global.SIZE * 8);
    return pop();
  }

  littera() {
    var digits, i, k, len, letters, ref, results;
    noStroke();
    fill('black');
    textSize(global.SIZE * 0.3);
    letters = this.flipped ? "hgfedcba" : "abcdefgh";
    digits = this.flipped ? "12345678" : "87654321";
    ref = range(8);
    results = [];
    for (k = 0, len = ref.length; k < len; k++) {
      i = ref[k];
      text(letters[i], global.SIZE * (i + 1), global.SIZE * 8.8);
      results.push(text(digits[i], global.SIZE * 0.15, global.SIZE * (i + 1)));
    }
    return results;
  }

  flip() {
    return this.flipped = !this.flipped;
  }

};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYm9hcmQuanMiLCJzb3VyY2VSb290IjoiLi4iLCJzb3VyY2VzIjpbImNvZmZlZVxcYm9hcmQuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxJQUFBLGVBQUE7RUFBQTs7QUFBQSxPQUFPLENBQVAsTUFBQTs7QUFDQSxPQUFBO0VBQVEsR0FBUjtFQUFZLElBQVo7RUFBaUIsS0FBakI7RUFBdUIsS0FBdkI7RUFBNkIsV0FBN0I7RUFBeUMsZUFBekM7Q0FBQSxNQUFBOztBQUNBLE9BQUE7RUFBUSxNQUFSO0NBQUEsTUFBQTs7QUFDQSxPQUFBO0VBQVEsTUFBUjtDQUFBLE1BQUE7O0FBQ0EsT0FBQTtFQUFRLE1BQVI7RUFBZSxXQUFmO0VBQTJCLE1BQTNCO0VBQWtDLGdCQUFsQztFQUFtRCxLQUFuRDtDQUFBLE1BQUE7O0FBQ0EsT0FBQTtFQUFRLFNBQVI7Q0FBQSxNQUFBLG1CQUxBOzs7QUFTQSxlQUFBLEdBQWtCLENBQUEsQ0FBQSxHQUFBO0FBQ2xCLE1BQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLEdBQUEsRUFBQSxJQUFBLEVBQUEsSUFBQSxFQUFBLEtBQUEsRUFBQSxFQUFBLEVBQUEsR0FBQSxFQUFBO0VBQUMsQ0FBQSxHQUFJO0VBQ0osRUFBQSxHQUFLLENBQUMsQ0FBQztFQUNQLElBQUcsRUFBRSxDQUFDLEtBQUssQ0FBQyxDQUFELENBQUcsQ0FBQyxNQUFaLEtBQXNCLENBQXpCO0FBQ0M7SUFBQSxLQUFBLHFDQUFBOztNQUNDLElBQUcsRUFBRSxDQUFDLE1BQUgsR0FBWSxFQUFFLENBQUMsU0FBUyxDQUFDLE1BQWIsR0FBb0IsQ0FBbkM7UUFDQyxFQUFBLEdBQUssRUFBRSxDQUFDLFNBQVMsQ0FBQyxFQUFFLENBQUMsTUFBSjtRQUNqQixFQUFFLENBQUMsR0FBSCxDQUFPO1VBQUMsQ0FBQSxFQUFFLENBQUMsQ0FBQyxJQUFJLENBQUMsR0FBRyxDQUFDLEVBQUQsQ0FBSSxDQUFDLENBQUQsQ0FBakI7VUFB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R0FBQSxFQUFBO0lBQUUsUUFBQSxDQUFBO0lBQ0EsSUFBQSxDQUFLLE9BQUw7SUFDQSxRQUFBLENBQVMsTUFBTSxDQUFDLElBQVAsR0FBWSxHQUFyQjtJQUNBLE9BQUEsR0FBYSxJQUFDLENBQUEsT0FBSixHQUFpQixVQUFqQixHQUFpQztJQUMzQyxNQUFBLEdBQVksSUFBQyxDQUFBLE9BQUosR0FBa0IsVUFBbEIsR0FBa0M7QUFFM0M7QUFBQTtJQUFBLEtBQUEscUNBQUE7O01BQ0MsSUFBQSxDQUFLLE9BQU8sQ0FBQyxDQUFELENBQVosRUFBZ0IsTUFBTSxDQUFDLElBQVAsR0FBWSxDQUFDLENBQUEsR0FBRSxDQUFILENBQTVCLEVBQWtDLE1BQU0sQ0FBQyxJQUFQLEdBQVksR0FBOUM7bUJBQ0EsSUFBQSxDQUFLLE1BQU0sQ0FBQyxDQUFELENBQVgsRUFBZSxNQUFNLENBQUMsSUFBUCxHQUFZLElBQTNCLEVBQWdDLE1BQU0sQ0FBQyxJQUFQLEdBQVksQ0FBQyxDQUFBLEdBQUUsQ0FBSCxDQUE1QztJQUZELENBQUE7O0VBUFM7O0VBV1YsSUFBTyxDQUFBLENBQUE7V0FBRyxJQUFDLENBQUEsT0FBRCxHQUFXLENBQUksSUFBQyxDQUFBO0VBQW5COztBQTFGRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2h0dHBzOi8vY2RuLnNreXBhY2suZGV2L2xvZGFzaCdcclxuaW1wb3J0IHthc3MsbGVycCxwYXJhbSxyYW5nZSxoZXhUb0Jhc2U2NCxlbnRlckZ1bGxzY3JlZW59IGZyb20gJy4uL2pzL3V0aWxzLmpzJ1xyXG5pbXBvcnQge1NxdWFyZX0gZnJvbSAnLi4vanMvc3F1YXJlLmpzJ1xyXG5pbXBvcnQge0J1dHRvbn0gZnJvbSAnLi4vanMvYnV0dG9uLmpzJ1xyXG5pbXBvcnQge2Nvb3JkcyxjbGlja1N0cmluZyxnbG9iYWwsdG9PYmplY3ROb3RhdGlvbix0b1VDSX0gZnJvbSAnLi4vanMvZ2xvYmFscy5qcydcclxuaW1wb3J0IHtkdW1wU3RhdGV9IGZyb20gJy4uL2pzL2dsb2JhbHMuanMnXHJcblxyXG4jU0laRSA9IGdsb2JhbC5TSVpFXHJcblxyXG5nZXROZXh0UXVlc3Rpb24gPSA9PlxyXG5cdGcgPSBnbG9iYWxcclxuXHRzciA9IGcuc3BhY2VkUmVwZXRpdGlvblxyXG5cdGlmIHNyLmJveGVzWzBdLmxlbmd0aCA9PSAwXHJcblx0XHRmb3IgaSBpbiByYW5nZSA1XHJcblx0XHRcdGlmIHNyLnFpbmRleCA8IHNyLnF1ZXN0aW9ucy5sZW5ndGgtMVxyXG5cdFx0XHRcdHFpID0gc3IucXVlc3Rpb25zW3NyLnFpbmRleF1cclxuXHRcdFx0XHRzci5hZGQge3A6Zy50cmVlLmFycltxaV1bM10sIHE6Zy50cmVlLmdldFBhdGgocWkpLCBhOiBnLnRyZWUuZ2V0QW5zd2VycyhxaSxzci5zdG9wcCl9XHJcblx0XHRcdFx0c3IucWluZGV4KytcclxuXHRzci5waWNrKClcclxuXHRnLmNoZXNzLnJlc2V0KClcclxuXHRtb3ZlcyA9IHNyLmN1cnJlbnQoKS5xLnNwbGl0ICcuJ1xyXG5cdGZvciBtb3ZlIGluIG1vdmVzXHJcblx0XHRnLmNoZXNzLm1vdmUge2Zyb206IG1vdmUuc2xpY2UoMCwyKSwgdG86bW92ZS5zbGljZSgyLDQpfVxyXG5cdGcuYm9hcmQuZmxpcHBlZCA9IG1vdmVzLmxlbmd0aCUyID09IDFcclxuXHJcbmV4cG9ydCBjbGFzcyBCb2FyZFxyXG5cdGNvbnN0cnVjdG9yOiAoQG5yKSAtPlxyXG5cdFx0QHNxdWFyZXMgPSBbXVxyXG5cdFx0QGNsaWNrZWRTcXVhcmVzID0gW11cclxuXHRcdEBwaWVjZXMgPSBcIlwiXHJcblx0XHRAZmxpcHBlZCA9IGZhbHNlXHJcblx0XHRmb3IgaSBpbiByYW5nZSA2NFxyXG5cdFx0XHRkbyAoaSkgPT4gQHNxdWFyZXMucHVzaCBuZXcgU3F1YXJlIEBuciwgaSwgPT4gQGNsaWNrIGlcclxuXHJcblx0XHRAYnV0dG9ucyA9IFtdXHJcblxyXG5cdGNsaWNrIDogKGkpID0+XHJcblx0XHRnID0gZ2xvYmFsXHJcblx0XHQjIHNyID0gZy5zcGFjZWRSZXBldGl0aW9uXHJcblx0XHRpZiBAZmxpcHBlZCB0aGVuIGkgPSA2My1pXHJcblx0XHRjb2wgPSBpICUlIDhcclxuXHRcdHJvdyA9IDctaSAvLyA4XHJcblx0XHRzcSA9IGcuY2hlc3MuYm9hcmQoKVtyb3ddW2NvbF1cclxuXHRcdGNvbG9yID0gXCJ3YlwiW2cuY2hlc3MuaGlzdG9yeSgpLmxlbmd0aCAlJSAyXSAjIGbDtnJ2w6RudGFkIGbDpHJnIHDDpSBwasOkc2VuXHJcblx0XHRjc2wgPSBAY2xpY2tlZFNxdWFyZXMubGVuZ3RoXHJcblx0XHRpZiBjc2wgPT0gMFxyXG5cdFx0XHRpZiBzcSAhPSBudWxsIGFuZCBzcS5jb2xvciA9PSBjb2xvciB0aGVuIEBjbGlja2VkU3F1YXJlcy5wdXNoIGlcclxuXHRcdGVsc2UgaWYgY3NsID09IDFcclxuXHRcdFx0aWYgaSA9PSBAY2xpY2tlZFNxdWFyZXNbMF0gIyDDpW5ncmEgb20gc2FtbWEgcnV0YVxyXG5cdFx0XHRcdEBjbGlja2VkU3F1YXJlcyA9IFtdXHJcblx0XHRcdGVsc2UgIyBrb250cm9sbGVyYSBkcmFnZXRcclxuXHRcdFx0XHRAY2xpY2tlZFNxdWFyZXMucHVzaCBpXHJcblx0XHRcdFx0dWNpID0gdG9VQ0kgQGNsaWNrZWRTcXVhcmVzXHJcblx0XHRcdFx0IyBpZiB1Y2kgaW4gc3IuYW5zd2Vyc1xyXG5cdFx0XHRcdFx0IyBzci5jb3JyZWN0KClcclxuXHRcdFx0XHRcdCMgZ2V0TmV4dFF1ZXN0aW9uKClcclxuXHRcdFx0XHRcdCMgQGNsaWNrZWRTcXVhcmVzID0gW11cclxuXHRcdGVsc2UgaWYgY3NsID09IDJcclxuXHRcdFx0QGNsaWNrZWRTcXVhcmVzLnB1c2ggaVxyXG5cdFx0ZWxzZSBpZiBjc2wgPT0gM1xyXG5cdFx0XHRAY2xpY2tlZFNxdWFyZXMucHVzaCBpXHJcblx0XHRcdHVjaSA9IHRvVUNJIEBjbGlja2VkU3F1YXJlcy5zbGljZSAyLDRcclxuXHRcdFx0IyBpZiB1Y2kgaW4gc3IuYW5zd2Vyc1xyXG5cdFx0XHRcdCMgc3Iud3JvbmcoKVxyXG5cdFx0XHRcdCMgZ2V0TmV4dFF1ZXN0aW9uKClcclxuXHRcdFx0XHQjIEBjbGlja2VkU3F1YXJlcyA9IFtdXHJcblx0XHRcdCMgZWxzZVxyXG5cdFx0XHQjIFx0QGNsaWNrZWRTcXVhcmVzID0gQGNsaWNrZWRTcXVhcmVzLnNsaWNlIDAsMlxyXG5cclxuXHRkcmF3IDogPT5cclxuXHJcblx0XHRmb3IgYnV0dG9uIGluIEBidXR0b25zXHJcblx0XHRcdGJ1dHRvbi5kcmF3KClcclxuXHJcblx0XHRmaWxsICd3aGl0ZSdcclxuXHRcdHRleHRTaXplIGdsb2JhbC5TSVpFKjAuM1xyXG5cclxuXHRcdGlmIEBucj09MFxyXG5cdFx0XHRwdXNoKClcclxuXHRcdFx0dHJhbnNsYXRlIGdsb2JhbC5teCwgZ2xvYmFsLm15XHJcblx0XHRlbHNlIFxyXG5cdFx0XHRwdXNoKClcclxuXHRcdFx0dHJhbnNsYXRlIGdsb2JhbC5teCwgZ2xvYmFsLm15ICsgOSAqIGdsb2JhbC5TSVpFXHJcblxyXG5cdFx0Zm9yIGkgaW4gcmFuZ2UgOFxyXG5cdFx0XHRmb3IgaiBpbiByYW5nZSA4XHJcblx0XHRcdFx0cGllY2UgPSBnbG9iYWwuY2hlc3MuYm9hcmQoKVs3LWldW2pdXHJcblx0XHRcdFx0c3EgPSBAc3F1YXJlc1tpKjgral1cclxuXHRcdFx0XHRpZiBAY2xpY2tlZFNxdWFyZXMubGVuZ3RoIGluIFswLDJdXHJcblx0XHRcdFx0XHRzcS5kcmF3IHBpZWNlLCBAZmxpcHBlZCwgZmFsc2VcclxuXHRcdFx0XHRpZiBAY2xpY2tlZFNxdWFyZXMubGVuZ3RoIGluIFsxXVxyXG5cdFx0XHRcdFx0c3EuZHJhdyBwaWVjZSwgQGZsaXBwZWQsIGkqOCtqPT1AY2xpY2tlZFNxdWFyZXNbMF1cclxuXHRcdFx0XHRlbHNlIGlmIEBjbGlja2VkU3F1YXJlcy5sZW5ndGggaW4gWzMsNF1cclxuXHRcdFx0XHRcdHNxLmRyYXcgcGllY2UsIEBmbGlwcGVkLCBpKjgraj09QGNsaWNrZWRTcXVhcmVzWzJdXHJcblxyXG5cdFx0c3Ryb2tlICdibGFjaydcclxuXHRcdG5vRmlsbCgpXHJcblx0XHRyZWN0IGdsb2JhbC5TSVpFKjQsZ2xvYmFsLlNJWkUqNCxnbG9iYWwuU0laRSo4LGdsb2JhbC5TSVpFKjhcclxuXHJcblx0XHRwb3AoKVxyXG5cclxuXHJcblx0XHQjQGxpdHRlcmEoKVxyXG5cclxuXHRsaXR0ZXJhIDogPT5cclxuXHRcdG5vU3Ryb2tlKClcclxuXHRcdGZpbGwgJ2JsYWNrJ1xyXG5cdFx0dGV4dFNpemUgZ2xvYmFsLlNJWkUqMC4zXHJcblx0XHRsZXR0ZXJzID0gaWYgQGZsaXBwZWQgdGhlbiBcImhnZmVkY2JhXCIgZWxzZSBcImFiY2RlZmdoXCJcclxuXHRcdGRpZ2l0cyA9IGlmIEBmbGlwcGVkIHRoZW4gIFwiMTIzNDU2NzhcIiBlbHNlIFwiODc2NTQzMjFcIlxyXG5cclxuXHRcdGZvciBpIGluIHJhbmdlIDhcclxuXHRcdFx0dGV4dCBsZXR0ZXJzW2ldLGdsb2JhbC5TSVpFKihpKzEpLGdsb2JhbC5TSVpFKjguOFxyXG5cdFx0XHR0ZXh0IGRpZ2l0c1tpXSxnbG9iYWwuU0laRSowLjE1LGdsb2JhbC5TSVpFKihpKzEpXHJcblxyXG5cdGZsaXAgOiA9PiBAZmxpcHBlZCA9IG5vdCBAZmxpcHBlZFxyXG4iXX0=
//# sourceURL=c:\github\2023-026-chessx2\coffee\board.coffee