// Generated by CoffeeScript 2.5.1
var modulo = function(a, b) { return (+a % (b = +b) + b) % b; };

import _ from 'https://cdn.skypack.dev/lodash';

import {
  ass,
  lerp,
  param,
  range,
  hexToBase64,
  enterFullscreen
} from '../js/utils.js';

import {
  Square
} from '../js/square.js';

import {
  Button
} from '../js/button.js';

import {
  coords,
  global,
  toObjectNotation,
  toUCI
} from '../js/globals.js';

import {
  dumpState
} from '../js/globals.js';

// copyToClipboard = (string) =>
// 	textarea = null
// 	result = null

  // 	try 
// 		textarea = document.createElement('textarea');
// 		textarea.setAttribute('readonly', true);
// 		textarea.setAttribute('contenteditable', true);
// 		textarea.style.position = 'fixed'; # prevent scroll from jumping to the bottom when focus is set.
// 		textarea.value = string

  // 		document.body.appendChild textarea

  // 		textarea.focus()
// 		textarea.select()

  // 		xrange = document.createRange()
// 		xrange.selectNodeContents(textarea)

  // 		sel = window.getSelection()
// 		sel.removeAllRanges()
// 		sel.addRange xrange

  // 		textarea.setSelectionRange 0, textarea.value.length
// 		result = document.execCommand 'copy'
// 	catch err
// 		alert err
// 		result = null
// 	finally
// 		document.body.removeChild textarea

  // 	#manual copy fallback using prompt
// 	if !result 
// 		isMac = navigator.platform.toUpperCase().indexOf('MAC') >= 0
// 		copyHotkey = isMac ? '⌘C' : 'CTRL+C';
// 		result = prompt("Press #{copyHotkey}", string); # eslint-disable-line no-alert
// 		if (!result) 
// 			return false
// 	return true

  // iosCopyToClipboard = (el) =>
// 	oldContentEditable = el.contentEditable
// 	oldReadOnly = el.readOnly
// 	xrange = document.createRange()

  // 	el.contentEditable = true
// 	el.readOnly = false
// 	xrange.selectNodeContents el

  // 	s = window.getSelection()
// 	s.removeAllRanges()
// 	s.addRange xrange

  // 	el.setSelectionRange 0, 999999 

  // 	el.contentEditable = oldContentEditable
// 	el.readOnly = oldReadOnly

  // 	document.execCommand 'copy'
export var Board = class Board {
  constructor(nr) {
    var i, k, len, ref;
    this.click = this.click.bind(this);
    this.draw = this.draw.bind(this);
    this.littera = this.littera.bind(this);
    this.nr = nr;
    this.squares = [];
    this.clickedSquares = [];
    this.pieces = "";
    ref = range(64);
    for (k = 0, len = ref.length; k < len; k++) {
      i = ref[k];
      ((i) => {
        return this.squares.push(new Square(this.nr, i, () => {
          return this.click(i);
        }));
      })(i);
    }
    this.buttons = [];
  }

  click(i) {
    var col, color, csl, g, row, sq, uci;
    g = global;
    if (this.nr === modulo(g.chess.history().length, 2)) {
      return;
    }
    col = modulo(i, 8);
    row = 7 - Math.floor(i / 8);
    sq = g.chess.board()[row][col];
    color = "wb"[modulo(g.chess.history().length, 2)];
    csl = this.clickedSquares.length;
    if (csl === 0) {
      if (sq !== null && sq.color === color) {
        return this.clickedSquares.push(i);
      }
    } else if (csl === 1) {
      if (i === this.clickedSquares[0]) {
        return this.clickedSquares = []; // kontrollera draget
      } else {
        this.clickedSquares.push(i);
        uci = toUCI(this.clickedSquares);
        // är detta ett korrekt drag? I så fall, utför det
        if (g.chess.move({
          from: uci.slice(0, 2),
          to: uci.slice(2, 4)
        })) {
          //input = document.getElementById "myInput"
          //input.value = g.chess.pgn()
          //copyToClipboard g.chess.pgn()
          //navigator.clipboard.writeText g.chess.pgn()
          //input = document.getElementById "myInput"

          // copyText = document.querySelector "#myInput"
          //g.pgn = g.chess.pgn()
          g.pgn = new Date().toLocaleString();
          return this.clickedSquares = [];
        } else {
          return this.clickedSquares.pop();
        }
      }
    }
  }

  draw() {
    var SIZE, button, i, j, k, l, len, len1, len2, m, piece, ref, ref1, ref2, ref3, ref4, ref5, sq;
    ref = this.buttons;
    for (k = 0, len = ref.length; k < len; k++) {
      button = ref[k];
      button.draw();
    }
    fill('white');
    textSize(global.size() * 0.3);
    push();
    if (this.nr === 0) {
      translate(global.mx(), global.my());
    } else {
      translate(global.mx(), global.my() + 9 * global.size());
    }
    ref1 = range(8);
    for (l = 0, len1 = ref1.length; l < len1; l++) {
      i = ref1[l];
      ref2 = range(8);
      for (m = 0, len2 = ref2.length; m < len2; m++) {
        j = ref2[m];
        piece = global.chess.board()[7 - i][j];
        sq = this.squares[i * 8 + j];
        if ((ref3 = this.clickedSquares.length) === 0 || ref3 === 2) {
          sq.draw(piece, false);
        }
        if ((ref4 = this.clickedSquares.length) === 1) {
          sq.draw(piece, i * 8 + j === this.clickedSquares[0]);
        } else if ((ref5 = this.clickedSquares.length) === 3 || ref5 === 4) {
          sq.draw(piece, i * 8 + j === this.clickedSquares[2]);
        }
      }
    }
    stroke('black');
    if (this.nr === global.chess.history().length % 2) {
      fill(128, 128, 128, 64);
    } else {
      noFill();
    }
    SIZE = global.size();
    rect(SIZE * 4, SIZE * 4, SIZE * 8, SIZE * 8);
    return pop();
  }

  littera() {
    var SIZE, digits, i, k, len, letters, ref, results;
    SIZE = global.size();
    noStroke();
    fill('black');
    textSize(SIZE * 0.3);
    letters = false ? "hgfedcba" : "abcdefgh";
    digits = false ? "12345678" : "87654321";
    ref = range(8);
    results = [];
    for (k = 0, len = ref.length; k < len; k++) {
      i = ref[k];
      text(letters[i], SIZE * (i + 1), SIZE * 8.8);
      results.push(text(digits[i], SIZE * 0.15, SIZE * (i + 1)));
    }
    return results;
  }

};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYm9hcmQuanMiLCJzb3VyY2VSb290IjoiLi4iLCJzb3VyY2VzIjpbImNvZmZlZVxcYm9hcmQuY29mZmVlIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxJQUFBOztBQUFBLE9BQU8sQ0FBUCxNQUFBOztBQUNBLE9BQUE7RUFBUSxHQUFSO0VBQVksSUFBWjtFQUFpQixLQUFqQjtFQUF1QixLQUF2QjtFQUE2QixXQUE3QjtFQUF5QyxlQUF6QztDQUFBLE1BQUE7O0FBQ0EsT0FBQTtFQUFRLE1BQVI7Q0FBQSxNQUFBOztBQUNBLE9BQUE7RUFBUSxNQUFSO0NBQUEsTUFBQTs7QUFDQSxPQUFBO0VBQVEsTUFBUjtFQUFlLE1BQWY7RUFBc0IsZ0JBQXRCO0VBQXVDLEtBQXZDO0NBQUEsTUFBQTs7QUFDQSxPQUFBO0VBQVEsU0FBUjtDQUFBLE1BQUEsbUJBTEE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFxRUEsT0FBQSxJQUFhLFFBQU4sTUFBQSxNQUFBO0VBQ04sV0FBYSxHQUFBLENBQUE7QUFDZCxRQUFBLENBQUEsRUFBQSxDQUFBLEVBQUEsR0FBQSxFQUFBO1FBUUMsQ0FBQSxZQUFBLENBQUE7UUFnQ0EsQ0FBQSxXQUFBLENBQUE7UUE2QkEsQ0FBQSxjQUFBLENBQUE7SUF0RWMsSUFBQyxDQUFBO0lBQ2QsSUFBQyxDQUFBLE9BQUQsR0FBVztJQUNYLElBQUMsQ0FBQSxjQUFELEdBQWtCO0lBQ2xCLElBQUMsQ0FBQSxNQUFELEdBQVU7QUFDVjtJQUFBLEtBQUEscUNBQUE7O01BQ0ksQ0FBQSxDQUFDLENBQUQsQ0FBQSxHQUFBO2VBQU8sSUFBQyxDQUFBLE9BQU8sQ0FBQyxJQUFULENBQWMsSUFBSSxNQUFKLENBQVcsSUFBQyxDQUFBLEVBQVosRUFBZ0IsQ0FBaEIsRUFBbUIsQ0FBQSxDQUFBLEdBQUE7aUJBQUcsSUFBQyxDQUFBLEtBQUQsQ0FBTyxDQUFQO1FBQUgsQ0FBbkIsQ0FBZDtNQUFQ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QTNCTTs7RUE2QlAsT0FBVSxDQUFBLENBQUE7QUFDWCxRQUFBLElBQUEsRUFBQSxNQUFBLEVBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxHQUFBLEVBQUEsT0FBQSxFQUFBLEdBQUEsRUFBQTtJQUFFLElBQUEsR0FBTyxNQUFNLENBQUMsSUFBUCxDQUFBO0lBQ1AsUUFBQSxDQUFBO0lBQ0EsSUFBQSxDQUFLLE9BQUw7SUFDQSxRQUFBLENBQVMsSUFBQSxHQUFLLEdBQWQ7SUFDQSxPQUFBLEdBQWEsS0FBSCxHQUFjLFVBQWQsR0FBOEI7SUFDeEMsTUFBQSxHQUFhLEtBQUgsR0FBYyxVQUFkLEdBQThCO0FBRXhDO0FBQUE7SUFBQSxLQUFBLHFDQUFBOztNQUNDLElBQUEsQ0FBSyxPQUFPLENBQUMsQ0FBRCxDQUFaLEVBQWdCLElBQUEsR0FBSyxDQUFDLENBQUEsR0FBRSxDQUFILENBQXJCLEVBQTJCLElBQUEsR0FBSyxHQUFoQzttQkFDQSxJQUFBLENBQUssTUFBTSxDQUFDLENBQUQsQ0FBWCxFQUFlLElBQUEsR0FBSyxJQUFwQixFQUF5QixJQUFBLEdBQUssQ0FBQyxDQUFBLEdBQUUsQ0FBSCxDQUE5QjtJQUZELENBQUE7O0VBUlM7O0FBdkVKIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IF8gZnJvbSAnaHR0cHM6Ly9jZG4uc2t5cGFjay5kZXYvbG9kYXNoJ1xyXG5pbXBvcnQge2FzcyxsZXJwLHBhcmFtLHJhbmdlLGhleFRvQmFzZTY0LGVudGVyRnVsbHNjcmVlbn0gZnJvbSAnLi4vanMvdXRpbHMuanMnXHJcbmltcG9ydCB7U3F1YXJlfSBmcm9tICcuLi9qcy9zcXVhcmUuanMnXHJcbmltcG9ydCB7QnV0dG9ufSBmcm9tICcuLi9qcy9idXR0b24uanMnXHJcbmltcG9ydCB7Y29vcmRzLGdsb2JhbCx0b09iamVjdE5vdGF0aW9uLHRvVUNJfSBmcm9tICcuLi9qcy9nbG9iYWxzLmpzJ1xyXG5pbXBvcnQge2R1bXBTdGF0ZX0gZnJvbSAnLi4vanMvZ2xvYmFscy5qcydcclxuXHJcbiMgY29weVRvQ2xpcGJvYXJkID0gKHN0cmluZykgPT5cclxuIyBcdHRleHRhcmVhID0gbnVsbFxyXG4jIFx0cmVzdWx0ID0gbnVsbFxyXG5cclxuIyBcdHRyeSBcclxuIyBcdFx0dGV4dGFyZWEgPSBkb2N1bWVudC5jcmVhdGVFbGVtZW50KCd0ZXh0YXJlYScpO1xyXG4jIFx0XHR0ZXh0YXJlYS5zZXRBdHRyaWJ1dGUoJ3JlYWRvbmx5JywgdHJ1ZSk7XHJcbiMgXHRcdHRleHRhcmVhLnNldEF0dHJpYnV0ZSgnY29udGVudGVkaXRhYmxlJywgdHJ1ZSk7XHJcbiMgXHRcdHRleHRhcmVhLnN0eWxlLnBvc2l0aW9uID0gJ2ZpeGVkJzsgIyBwcmV2ZW50IHNjcm9sbCBmcm9tIGp1bXBpbmcgdG8gdGhlIGJvdHRvbSB3aGVuIGZvY3VzIGlzIHNldC5cclxuIyBcdFx0dGV4dGFyZWEudmFsdWUgPSBzdHJpbmdcclxuXHJcbiMgXHRcdGRvY3VtZW50LmJvZHkuYXBwZW5kQ2hpbGQgdGV4dGFyZWFcclxuXHJcbiMgXHRcdHRleHRhcmVhLmZvY3VzKClcclxuIyBcdFx0dGV4dGFyZWEuc2VsZWN0KClcclxuXHJcbiMgXHRcdHhyYW5nZSA9IGRvY3VtZW50LmNyZWF0ZVJhbmdlKClcclxuIyBcdFx0eHJhbmdlLnNlbGVjdE5vZGVDb250ZW50cyh0ZXh0YXJlYSlcclxuXHJcbiMgXHRcdHNlbCA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKVxyXG4jIFx0XHRzZWwucmVtb3ZlQWxsUmFuZ2VzKClcclxuIyBcdFx0c2VsLmFkZFJhbmdlIHhyYW5nZVxyXG5cclxuIyBcdFx0dGV4dGFyZWEuc2V0U2VsZWN0aW9uUmFuZ2UgMCwgdGV4dGFyZWEudmFsdWUubGVuZ3RoXHJcbiMgXHRcdHJlc3VsdCA9IGRvY3VtZW50LmV4ZWNDb21tYW5kICdjb3B5J1xyXG4jIFx0Y2F0Y2ggZXJyXHJcbiMgXHRcdGFsZXJ0IGVyclxyXG4jIFx0XHRyZXN1bHQgPSBudWxsXHJcbiMgXHRmaW5hbGx5XHJcbiMgXHRcdGRvY3VtZW50LmJvZHkucmVtb3ZlQ2hpbGQgdGV4dGFyZWFcclxuXHRcclxuXHJcbiMgXHQjbWFudWFsIGNvcHkgZmFsbGJhY2sgdXNpbmcgcHJvbXB0XHJcbiMgXHRpZiAhcmVzdWx0IFxyXG4jIFx0XHRpc01hYyA9IG5hdmlnYXRvci5wbGF0Zm9ybS50b1VwcGVyQ2FzZSgpLmluZGV4T2YoJ01BQycpID49IDBcclxuIyBcdFx0Y29weUhvdGtleSA9IGlzTWFjID8gJ+KMmEMnIDogJ0NUUkwrQyc7XHJcbiMgXHRcdHJlc3VsdCA9IHByb21wdChcIlByZXNzICN7Y29weUhvdGtleX1cIiwgc3RyaW5nKTsgIyBlc2xpbnQtZGlzYWJsZS1saW5lIG5vLWFsZXJ0XHJcbiMgXHRcdGlmICghcmVzdWx0KSBcclxuIyBcdFx0XHRyZXR1cm4gZmFsc2VcclxuIyBcdHJldHVybiB0cnVlXHJcblxyXG5cclxuIyBpb3NDb3B5VG9DbGlwYm9hcmQgPSAoZWwpID0+XHJcbiMgXHRvbGRDb250ZW50RWRpdGFibGUgPSBlbC5jb250ZW50RWRpdGFibGVcclxuIyBcdG9sZFJlYWRPbmx5ID0gZWwucmVhZE9ubHlcclxuIyBcdHhyYW5nZSA9IGRvY3VtZW50LmNyZWF0ZVJhbmdlKClcclxuXHJcbiMgXHRlbC5jb250ZW50RWRpdGFibGUgPSB0cnVlXHJcbiMgXHRlbC5yZWFkT25seSA9IGZhbHNlXHJcbiMgXHR4cmFuZ2Uuc2VsZWN0Tm9kZUNvbnRlbnRzIGVsXHJcblxyXG4jIFx0cyA9IHdpbmRvdy5nZXRTZWxlY3Rpb24oKVxyXG4jIFx0cy5yZW1vdmVBbGxSYW5nZXMoKVxyXG4jIFx0cy5hZGRSYW5nZSB4cmFuZ2VcclxuXHJcbiMgXHRlbC5zZXRTZWxlY3Rpb25SYW5nZSAwLCA5OTk5OTkgXHJcblxyXG4jIFx0ZWwuY29udGVudEVkaXRhYmxlID0gb2xkQ29udGVudEVkaXRhYmxlXHJcbiMgXHRlbC5yZWFkT25seSA9IG9sZFJlYWRPbmx5XHJcblxyXG4jIFx0ZG9jdW1lbnQuZXhlY0NvbW1hbmQgJ2NvcHknXHJcblxyXG5leHBvcnQgY2xhc3MgQm9hcmRcclxuXHRjb25zdHJ1Y3RvcjogKEBucikgLT5cclxuXHRcdEBzcXVhcmVzID0gW11cclxuXHRcdEBjbGlja2VkU3F1YXJlcyA9IFtdXHJcblx0XHRAcGllY2VzID0gXCJcIlxyXG5cdFx0Zm9yIGkgaW4gcmFuZ2UgNjRcclxuXHRcdFx0ZG8gKGkpID0+IEBzcXVhcmVzLnB1c2ggbmV3IFNxdWFyZSBAbnIsIGksID0+IEBjbGljayBpXHJcblxyXG5cdFx0QGJ1dHRvbnMgPSBbXVxyXG5cclxuXHRjbGljayA6IChpKSA9PlxyXG5cdFx0ZyA9IGdsb2JhbFxyXG5cdFx0aWYgQG5yID09IGcuY2hlc3MuaGlzdG9yeSgpLmxlbmd0aCAlJSAyIHRoZW4gcmV0dXJuXHJcblx0XHRjb2wgPSBpICUlIDhcclxuXHRcdHJvdyA9IDcgLSBpIC8vIDhcclxuXHRcdHNxID0gZy5jaGVzcy5ib2FyZCgpW3Jvd11bY29sXVxyXG5cdFx0Y29sb3IgPSBcIndiXCJbZy5jaGVzcy5oaXN0b3J5KCkubGVuZ3RoICUlIDJdICMgZsO2cnbDpG50YWQgZsOkcmcgcMOlIHBqw6RzZW5cclxuXHRcdGNzbCA9IEBjbGlja2VkU3F1YXJlcy5sZW5ndGhcclxuXHRcdGlmIGNzbCA9PSAwXHJcblx0XHRcdGlmIHNxICE9IG51bGwgYW5kIHNxLmNvbG9yID09IGNvbG9yIHRoZW4gQGNsaWNrZWRTcXVhcmVzLnB1c2ggaVxyXG5cdFx0ZWxzZSBpZiBjc2wgPT0gMVxyXG5cdFx0XHRpZiBpID09IEBjbGlja2VkU3F1YXJlc1swXSAjIMOlbmdyYSBvbSBzYW1tYSBydXRhXHJcblx0XHRcdFx0QGNsaWNrZWRTcXVhcmVzID0gW11cclxuXHRcdFx0ZWxzZSAjIGtvbnRyb2xsZXJhIGRyYWdldFxyXG5cdFx0XHRcdEBjbGlja2VkU3F1YXJlcy5wdXNoIGlcclxuXHRcdFx0XHR1Y2kgPSB0b1VDSSBAY2xpY2tlZFNxdWFyZXNcclxuXHRcdFx0XHQjIMOkciBkZXR0YSBldHQga29ycmVrdCBkcmFnPyBJIHPDpSBmYWxsLCB1dGbDtnIgZGV0XHJcblx0XHRcdFx0aWYgZy5jaGVzcy5tb3ZlIHtmcm9tOnVjaS5zbGljZSgwLDIpLCB0bzp1Y2kuc2xpY2UoMiw0KX1cclxuXHRcdFx0XHRcdCNpbnB1dCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkIFwibXlJbnB1dFwiXHJcblx0XHRcdFx0XHQjaW5wdXQudmFsdWUgPSBnLmNoZXNzLnBnbigpXHJcblx0XHRcdFx0XHQjY29weVRvQ2xpcGJvYXJkIGcuY2hlc3MucGduKClcclxuXHRcdFx0XHRcdCNuYXZpZ2F0b3IuY2xpcGJvYXJkLndyaXRlVGV4dCBnLmNoZXNzLnBnbigpXHJcblx0XHRcdFx0XHQjaW5wdXQgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCBcIm15SW5wdXRcIlxyXG5cclxuXHRcdFx0XHRcdCMgY29weVRleHQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yIFwiI215SW5wdXRcIlxyXG5cdFx0XHRcdFx0I2cucGduID0gZy5jaGVzcy5wZ24oKVxyXG5cdFx0XHRcdFx0Zy5wZ24gPSBuZXcgRGF0ZSgpLnRvTG9jYWxlU3RyaW5nKClcclxuXHJcblx0XHRcdFx0XHRAY2xpY2tlZFNxdWFyZXMgPSBbXVxyXG5cdFx0XHRcdGVsc2VcclxuXHRcdFx0XHRcdEBjbGlja2VkU3F1YXJlcy5wb3AoKVxyXG5cclxuXHRkcmF3IDogPT5cclxuXHJcblx0XHRmb3IgYnV0dG9uIGluIEBidXR0b25zXHJcblx0XHRcdGJ1dHRvbi5kcmF3KClcclxuXHJcblx0XHRmaWxsICd3aGl0ZSdcclxuXHRcdHRleHRTaXplIGdsb2JhbC5zaXplKCkgKiAwLjNcclxuXHJcblx0XHRwdXNoKClcclxuXHRcdGlmIEBucj09MCB0aGVuIHRyYW5zbGF0ZSBnbG9iYWwubXgoKSwgZ2xvYmFsLm15KClcclxuXHRcdGVsc2UgdHJhbnNsYXRlIGdsb2JhbC5teCgpLCBnbG9iYWwubXkoKSArIDkgKiBnbG9iYWwuc2l6ZSgpXHJcblxyXG5cdFx0Zm9yIGkgaW4gcmFuZ2UgOFxyXG5cdFx0XHRmb3IgaiBpbiByYW5nZSA4XHJcblx0XHRcdFx0cGllY2UgPSBnbG9iYWwuY2hlc3MuYm9hcmQoKVs3LWldW2pdXHJcblx0XHRcdFx0c3EgPSBAc3F1YXJlc1tpKjgral1cclxuXHRcdFx0XHRpZiBAY2xpY2tlZFNxdWFyZXMubGVuZ3RoIGluIFswLDJdXHJcblx0XHRcdFx0XHRzcS5kcmF3IHBpZWNlLCBmYWxzZVxyXG5cdFx0XHRcdGlmIEBjbGlja2VkU3F1YXJlcy5sZW5ndGggaW4gWzFdXHJcblx0XHRcdFx0XHRzcS5kcmF3IHBpZWNlLCBpKjgraj09QGNsaWNrZWRTcXVhcmVzWzBdXHJcblx0XHRcdFx0ZWxzZSBpZiBAY2xpY2tlZFNxdWFyZXMubGVuZ3RoIGluIFszLDRdXHJcblx0XHRcdFx0XHRzcS5kcmF3IHBpZWNlLCBpKjgraj09QGNsaWNrZWRTcXVhcmVzWzJdXHJcblxyXG5cdFx0c3Ryb2tlICdibGFjaydcclxuXHRcdGlmIEBuciA9PSBnbG9iYWwuY2hlc3MuaGlzdG9yeSgpLmxlbmd0aCUyIHRoZW4gZmlsbCAxMjgsMTI4LDEyOCw2NCBlbHNlIG5vRmlsbCgpXHJcblx0XHRTSVpFID0gZ2xvYmFsLnNpemUoKVxyXG5cdFx0cmVjdCBTSVpFKjQsU0laRSo0LFNJWkUqOCxTSVpFKjhcclxuXHRcdHBvcCgpXHJcblxyXG5cdGxpdHRlcmEgOiA9PlxyXG5cdFx0U0laRSA9IGdsb2JhbC5zaXplKClcclxuXHRcdG5vU3Ryb2tlKClcclxuXHRcdGZpbGwgJ2JsYWNrJ1xyXG5cdFx0dGV4dFNpemUgU0laRSowLjNcclxuXHRcdGxldHRlcnMgPSBpZiBmYWxzZSB0aGVuIFwiaGdmZWRjYmFcIiBlbHNlIFwiYWJjZGVmZ2hcIlxyXG5cdFx0ZGlnaXRzICA9IGlmIGZhbHNlIHRoZW4gXCIxMjM0NTY3OFwiIGVsc2UgXCI4NzY1NDMyMVwiXHJcblxyXG5cdFx0Zm9yIGkgaW4gcmFuZ2UgOFxyXG5cdFx0XHR0ZXh0IGxldHRlcnNbaV0sU0laRSooaSsxKSxTSVpFKjguOFxyXG5cdFx0XHR0ZXh0IGRpZ2l0c1tpXSxTSVpFKjAuMTUsU0laRSooaSsxKVxyXG4iXX0=
//# sourceURL=c:\github\2023-026-chessx2\coffee\board.coffee