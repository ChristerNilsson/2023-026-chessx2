// Generated by CoffeeScript 2.5.1
var arr, fullScreen, released, resize;

import _ from 'https://cdn.skypack.dev/lodash';

import {
  ass,
  log,
  range,
  enterFullscreen,
  signal
} from '../js/utils.js';

import {
  Board
} from '../js/board.js';

import {
  Button
} from '../js/button.js';

import {
  global
} from '../js/globals.js';

released = true; // prevention of touch bounce

arr = null;

window.preload = () => {
  var i, j, len, len1, letter, ref, ref1, results;
  ref = "rnbqkp";
  for (i = 0, len = ref.length; i < len; i++) {
    letter = ref[i];
    global.pics[letter] = loadImage('./images/b' + letter + '.png');
  }
  ref1 = "RNBQKP";
  results = [];
  for (j = 0, len1 = ref1.length; j < len1; j++) {
    letter = ref1[j];
    results.push(global.pics[letter] = loadImage('./images/w' + letter.toLowerCase() + '.png'));
  }
  return results;
};

fullScreen = () => {
  return enterFullscreen();
};

window.setup = () => {
  createCanvas(innerWidth, innerHeight);
  [global.size, global.setSize] = signal(round(min(innerWidth, innerHeight) / 18));
  //global.size = size
  //global.setSize = setSize
  [global.mx, global.setMx] = signal(round((innerWidth - 8 * global.size()) / 2));
  //global.mx = mx
  //global.setMx = setMx
  [global.my, global.setMy] = signal(round((innerHeight - 17 * global.size()) / 2));
  //global.my = my
  //global.setMy = setMy
  resize();
  textAlign(CENTER, CENTER);
  rectMode(CENTER);
  imageMode(CENTER);
  global.board0 = new Board(0);
  global.board1 = new Board(1);
  return global.chess = new Chess();
};

window.draw = () => {
  var button, i, len, ref;
  background('gray');
  textSize(global.size());
  global.board0.draw();
  global.board1.draw();
  ref = global.buttons;
  for (i = 0, len = ref.length; i < len; i++) {
    button = ref[i];
    button.draw();
  }
  fill("black");
  return textAlign(CENTER, CENTER);
};

window.onresize = function() {
  return resize();
};

resize = function() {
  global.setSize(round(innerHeight / 18));
  resizeCanvas(innerWidth, innerHeight);
  global.setMx(round((innerWidth - 8 * global.size()) / 2));
  console.log('size', global.size());
  global.setMy(round((innerHeight - 17 * global.size()) / 2));
  global.buttons = [];
  global.buttons.push(new Button(round(2 * width / 3), round(height / 2), 'Full Screen', fullScreen));
  return global.buttons.push(new Button(round(width / 3), round(height / 2), 'Copy', () => {
    return navigator.clipboard.writeText(global.chess.pgn());
  }));
};

window.mousePressed = () => {
  var button, i, j, len, len1, ref, ref1, square;
  console.log('mousePressed');
  if (!released) {
    return;
  }
  released = false;
  ref = global.buttons.concat(global.buttons);
  for (i = 0, len = ref.length; i < len; i++) {
    button = ref[i];
    if (button.inside(mouseX, mouseY)) {
      button.onclick();
      return false;
    }
  }
  ref1 = global.board0.squares.concat(global.board1.squares);
  for (j = 0, len1 = ref1.length; j < len1; j++) {
    square = ref1[j];
    if (square.inside(mouseX, mouseY)) {
      console.log('square.inside', square.nr);
      square.onclick();
      return false;
    }
  }
  return false;
};

window.mouseReleased = () => {
  released = true;
  return false;
};

//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoic2tldGNoLmpzIiwic291cmNlUm9vdCI6Ii4uIiwic291cmNlcyI6WyJjb2ZmZWVcXHNrZXRjaC5jb2ZmZWUiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IjtBQUFBLElBQUEsR0FBQSxFQUFBLFVBQUEsRUFBQSxRQUFBLEVBQUE7O0FBQUEsT0FBTyxDQUFQLE1BQUE7O0FBQ0EsT0FBQTtFQUFRLEdBQVI7RUFBWSxHQUFaO0VBQWdCLEtBQWhCO0VBQXNCLGVBQXRCO0VBQXNDLE1BQXRDO0NBQUEsTUFBQTs7QUFDQSxPQUFBO0VBQVEsS0FBUjtDQUFBLE1BQUE7O0FBQ0EsT0FBQTtFQUFRLE1BQVI7Q0FBQSxNQUFBOztBQUNBLE9BQUE7RUFBUSxNQUFSO0NBQUEsTUFBQTs7QUFFQSxRQUFBLEdBQVcsS0FOWDs7QUFPQSxHQUFBLEdBQU07O0FBRU4sTUFBTSxDQUFDLE9BQVAsR0FBaUIsQ0FBQSxDQUFBLEdBQUE7QUFDakIsTUFBQSxDQUFBLEVBQUEsQ0FBQSxFQUFBLEdBQUEsRUFBQSxJQUFBLEVBQUEsTUFBQSxFQUFBLEdBQUEsRUFBQSxJQUFBLEVBQUE7QUFBQztFQUFBLEtBQUEscUNBQUE7O0lBQ0MsTUFBTSxDQUFDLElBQUksQ0FBQyxNQUFELENBQVgsR0FBc0IsU0FBQSxDQUFVLFlBQUEsR0FBZSxNQUFmLEdBQXdCLE1BQWxDO0VBRHZCO0FBRUE7QUFBQTtFQUFBLEtBQUEsd0NBQUE7O2lCQUNDLE1BQU0sQ0FBQyxJQUFJLENBQUMsTUFBRCxDQUFYLEdBQXNCLFNBQUEsQ0FBVSxZQUFBLEdBQWUsTUFBTSxDQUFDLFdBQVAsQ0FBQSxDQUFmLEdBQXNDLE1BQWhEO0VBRHZCLENBQUE7O0FBSGdCOztBQU1qQixVQUFBLEdBQWEsQ0FBQSxDQUFBLEdBQUE7U0FBRyxlQUFBLENBQUE7QUFBSDs7QUFFYixNQUFNLENBQUMsS0FBUCxHQUFlLENBQUEsQ0FBQSxHQUFBO0VBRWQsWUFBQSxDQUFhLFVBQWIsRUFBd0IsV0FBeEI7RUFFQSxDQUFDLE1BQU0sQ0FBQyxJQUFS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QUE4QixNQUFNLENBQUMsS0FBSyxDQUFDLEdBQWIsQ0FBQSxDQUE5QjtFQUFOLENBQW5ELENBQXBCO0FBUlE7O0FBVVQsTUFBTSxDQUFDLFlBQVAsR0FBc0IsQ0FBQSxDQUFBLEdBQUE7QUFDdEIsTUFBQSxNQUFBLEVBQUEsQ0FBQSxFQUFBLENBQUEsRUFBQSxHQUFBLEVBQUEsSUFBQSxFQUFBLEdBQUEsRUFBQSxJQUFBLEVBQUE7RUFBQyxPQUFPLENBQUMsR0FBUixDQUFZLGNBQVo7RUFDQSxJQUFHLENBQUksUUFBUDtBQUFxQixXQUFyQjs7RUFDQSxRQUFBLEdBQVc7QUFFWDtFQUFBLEtBQUEscUNBQUE7O0lBQ0MsSUFBRyxNQUFNLENBQUMsTUFBUCxDQUFjLE1BQWQsRUFBcUIsTUFBckIsQ0FBSDtNQUNDLE1BQU0sQ0FBQyxPQUFQLENBQUE7QUFDQSxhQUFPLE1BRlI7O0VBREQ7QUFJQTtFQUFBLEtBQUEsd0NBQUE7O0lBQ0MsSUFBRyxNQUFNLENBQUMsTUFBUCxDQUFjLE1BQWQsRUFBcUIsTUFBckIsQ0FBSDtNQUNDLE9BQU8sQ0FBQyxHQUFSLENBQVksZUFBWixFQUE0QixNQUFNLENBQUMsRUFBbkM7TUFDQSxNQUFNLENBQUMsT0FBUCxDQUFBO0FBQ0EsYUFBTyxNQUhSOztFQUREO1NBS0E7QUFkcUI7O0FBZ0J0QixNQUFNLENBQUMsYUFBUCxHQUF1QixDQUFBLENBQUEsR0FBQTtFQUN0QixRQUFBLEdBQVc7U0FDWDtBQUZzQiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBfIGZyb20gJ2h0dHBzOi8vY2RuLnNreXBhY2suZGV2L2xvZGFzaCdcclxuaW1wb3J0IHthc3MsbG9nLHJhbmdlLGVudGVyRnVsbHNjcmVlbixzaWduYWx9IGZyb20gJy4uL2pzL3V0aWxzLmpzJ1xyXG5pbXBvcnQge0JvYXJkfSBmcm9tICcuLi9qcy9ib2FyZC5qcydcclxuaW1wb3J0IHtCdXR0b259IGZyb20gJy4uL2pzL2J1dHRvbi5qcydcclxuaW1wb3J0IHtnbG9iYWx9IGZyb20gJy4uL2pzL2dsb2JhbHMuanMnXHJcblxyXG5yZWxlYXNlZCA9IHRydWUgIyBwcmV2ZW50aW9uIG9mIHRvdWNoIGJvdW5jZVxyXG5hcnIgPSBudWxsXHJcblxyXG53aW5kb3cucHJlbG9hZCA9ID0+XHJcblx0Zm9yIGxldHRlciBpbiBcInJuYnFrcFwiXHJcblx0XHRnbG9iYWwucGljc1tsZXR0ZXJdID0gbG9hZEltYWdlICcuL2ltYWdlcy9iJyArIGxldHRlciArICcucG5nJ1xyXG5cdGZvciBsZXR0ZXIgaW4gXCJSTkJRS1BcIlxyXG5cdFx0Z2xvYmFsLnBpY3NbbGV0dGVyXSA9IGxvYWRJbWFnZSAnLi9pbWFnZXMvdycgKyBsZXR0ZXIudG9Mb3dlckNhc2UoKSArICcucG5nJ1xyXG5cclxuZnVsbFNjcmVlbiA9ID0+IGVudGVyRnVsbHNjcmVlbigpXHJcblxyXG53aW5kb3cuc2V0dXAgPSA9PlxyXG5cclxuXHRjcmVhdGVDYW52YXMgaW5uZXJXaWR0aCxpbm5lckhlaWdodFxyXG5cclxuXHRbZ2xvYmFsLnNpemUsIGdsb2JhbC5zZXRTaXplXSA9IHNpZ25hbCByb3VuZCBtaW4oaW5uZXJXaWR0aCxpbm5lckhlaWdodCkvMThcclxuXHQjZ2xvYmFsLnNpemUgPSBzaXplXHJcblx0I2dsb2JhbC5zZXRTaXplID0gc2V0U2l6ZVxyXG5cdFtnbG9iYWwubXgsIGdsb2JhbC5zZXRNeF0gPSBzaWduYWwgcm91bmQgKGlubmVyV2lkdGggLSA4ICogZ2xvYmFsLnNpemUoKSkvMlxyXG5cdCNnbG9iYWwubXggPSBteFxyXG5cdCNnbG9iYWwuc2V0TXggPSBzZXRNeFxyXG5cdFtnbG9iYWwubXksIGdsb2JhbC5zZXRNeV0gPSBzaWduYWwgcm91bmQgKGlubmVySGVpZ2h0IC0gMTcgKiBnbG9iYWwuc2l6ZSgpKS8yXHJcblx0I2dsb2JhbC5teSA9IG15XHJcblx0I2dsb2JhbC5zZXRNeSA9IHNldE15XHJcblxyXG5cdHJlc2l6ZSgpXHJcblxyXG5cdHRleHRBbGlnbiBDRU5URVIsQ0VOVEVSXHJcblx0cmVjdE1vZGUgQ0VOVEVSXHJcblx0aW1hZ2VNb2RlIENFTlRFUlxyXG5cclxuXHRnbG9iYWwuYm9hcmQwID0gbmV3IEJvYXJkIDBcclxuXHRnbG9iYWwuYm9hcmQxID0gbmV3IEJvYXJkIDFcclxuXHRnbG9iYWwuY2hlc3MgPSBuZXcgQ2hlc3MoKVxyXG5cclxud2luZG93LmRyYXcgPSA9PlxyXG5cdGJhY2tncm91bmQgJ2dyYXknXHJcblx0dGV4dFNpemUgZ2xvYmFsLnNpemUoKVxyXG5cdGdsb2JhbC5ib2FyZDAuZHJhdygpXHJcblx0Z2xvYmFsLmJvYXJkMS5kcmF3KClcclxuXHRmb3IgYnV0dG9uIGluIGdsb2JhbC5idXR0b25zXHJcblx0XHRidXR0b24uZHJhdygpXHJcblx0ZmlsbCBcImJsYWNrXCJcclxuXHR0ZXh0QWxpZ24gQ0VOVEVSLENFTlRFUlxyXG5cclxud2luZG93Lm9ucmVzaXplID0gLT4gcmVzaXplKClcclxuXHJcbnJlc2l6ZSA9IC0+XHJcblx0Z2xvYmFsLnNldFNpemUgcm91bmQgaW5uZXJIZWlnaHQvMThcclxuXHRyZXNpemVDYW52YXMgaW5uZXJXaWR0aCwgaW5uZXJIZWlnaHRcclxuXHRnbG9iYWwuc2V0TXggcm91bmQgKGlubmVyV2lkdGggLSA4ICogZ2xvYmFsLnNpemUoKSkvMlxyXG5cdGNvbnNvbGUubG9nICdzaXplJyxnbG9iYWwuc2l6ZSgpXHJcblx0Z2xvYmFsLnNldE15IHJvdW5kIChpbm5lckhlaWdodCAtIDE3ICogZ2xvYmFsLnNpemUoKSkvMlxyXG5cdGdsb2JhbC5idXR0b25zID0gW11cclxuXHRnbG9iYWwuYnV0dG9ucy5wdXNoIG5ldyBCdXR0b24gcm91bmQoMip3aWR0aC8zKSxyb3VuZChoZWlnaHQvMiksICdGdWxsIFNjcmVlbicsIGZ1bGxTY3JlZW5cclxuXHRnbG9iYWwuYnV0dG9ucy5wdXNoIG5ldyBCdXR0b24gcm91bmQod2lkdGgvMykscm91bmQoaGVpZ2h0LzIpLCAnQ29weScsICgpID0+IG5hdmlnYXRvci5jbGlwYm9hcmQud3JpdGVUZXh0IGdsb2JhbC5jaGVzcy5wZ24oKVxyXG5cclxud2luZG93Lm1vdXNlUHJlc3NlZCA9ID0+XHJcblx0Y29uc29sZS5sb2cgJ21vdXNlUHJlc3NlZCdcclxuXHRpZiBub3QgcmVsZWFzZWQgdGhlbiByZXR1cm5cclxuXHRyZWxlYXNlZCA9IGZhbHNlXHJcblxyXG5cdGZvciBidXR0b24gaW4gZ2xvYmFsLmJ1dHRvbnMuY29uY2F0IGdsb2JhbC5idXR0b25zXHJcblx0XHRpZiBidXR0b24uaW5zaWRlIG1vdXNlWCxtb3VzZVlcclxuXHRcdFx0YnV0dG9uLm9uY2xpY2soKVxyXG5cdFx0XHRyZXR1cm4gZmFsc2VcclxuXHRmb3Igc3F1YXJlIGluIGdsb2JhbC5ib2FyZDAuc3F1YXJlcy5jb25jYXQgZ2xvYmFsLmJvYXJkMS5zcXVhcmVzXHJcblx0XHRpZiBzcXVhcmUuaW5zaWRlIG1vdXNlWCxtb3VzZVlcclxuXHRcdFx0Y29uc29sZS5sb2cgJ3NxdWFyZS5pbnNpZGUnLHNxdWFyZS5uclxyXG5cdFx0XHRzcXVhcmUub25jbGljaygpXHJcblx0XHRcdHJldHVybiBmYWxzZVxyXG5cdGZhbHNlXHJcblxyXG53aW5kb3cubW91c2VSZWxlYXNlZCA9ID0+XHJcblx0cmVsZWFzZWQgPSB0cnVlXHJcblx0ZmFsc2UiXX0=
//# sourceURL=c:\github\2023-026-chessx2\coffee\sketch.coffee